<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>Cadastro</title>
<style>
  body{
    margin-left: auto;
    margin-right: auto;
    background-color: #FFFFFF;  
}
img{
    width: 110%;
    padding: 55px;
}
header{
    position: fixed;
    left: 0;
    top: 0;
    width: 100%;
    padding: 0px 0;  
}
h1{
    text-align: center
}
.navbar-brand{
    padding: 0;
    color:white;
}
.navbar-brand:hover{
    color: white;
}

.navbarNavAltMarkup{
    color: white;
}
footer{
    padding: 70px;
    background-color: rgba(0, 0, 0, 0.6);;
    margin-top: 50%;
    display: table;
    width:100% ;
   
    height: 100%; /* altura do rodapé */
    padding: 0px;
    left: 0;
    bottom: 0;
}
.content {
    padding-bottom: 0px; /* altura do rodapé */
  }

footer dl, footer p{
    display: table-cell;
    vertical-align: middle;
    color: white;
}

footer dt{
    font-weight: bold;
    color: white;
}
footer p{
    text-align: right;
    font-weight: bold;
    font-size: 25px;
    color: white;

}
form{
    color: white;
    position:absolute;
    display:flexbox;
    top: 60%;
    left: 50%;
    transform: translate(-50%,-50%);
    background-color: rgba(0, 0, 0, 0.6);
    padding: 20px;
    border-radius: 15px;
    width: 35%;
}
#botao{
    width:100% ;
    background-color: rgb(43, 53, 184);
}
</style>

{% if messages %}
<div class="alert alert-danger" role="alert">
  <ul class="mb-0">
    {% for message in messages %}
      <li>{{ message }}</li>
    {% endfor %}
  </ul>
</div>
{% endif %}

  </head>
<body>
  <header>
    <nav class="navbar navbar-expand-lg bg-body-tertiary, navbar navbar-light" style="background-color: rgba(0, 0, 0, 0.6);">
        <div class="container-fluid">
          <a class="navbar-brand" href="{% url 'operacional' %}">Park Controll</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
              <a class="nav-link" href="{% url 'operacional' %}"><font color="white">Operacional</font></a>
              <a class="nav-link" href="{% url 'consulta' %}"><font color="white">Consultar</font></a>
              <a class="nav-link" href="{% url 'cadastro' %}"><font color="white">Cadastrar</font></a>                
            </div>
          </div>
        </div>
      </nav>
      
</header>
<STYLE TYPE="text/css">
  BODY {background-image: url(fundo.jpg); background-repeat: atrinobuto; }
</STYLE>

    <div name="form" class="container col-md-4">  
        <br><br><br>  
        
        <form action="{% url 'cadastro' %}" method="post" id="cadastroForm">  {% csrf_token %}
            <fieldset>
              <legend><b>Cadastro de veículo</b></legend>
              <div class="mb-3">
                  <label for="exampleFormControlInput1" class="form-label">Placa</label>
                  <input type="text" minlength="7" maxlength="7" name="placa" class="form-control" id="placa">
              </div>           
              <label class="form-label">Tipo de veículo</label><br>
              <select class="form-select" name="tipo">
                  <option selected value="carro">Carro</option>
                  <option value="moto">Moto</option>
                  <option value="camionete">Camionete</option>
              </select>  
              <div class="mb-0">
                <br><label for="exampleFormControlInput1" class="form-label">Marca</label>
                <input type="text" maxlength="20" name="marca" class="form-control" id="marca">
              </div>   
              <div class="mb-3">
                  <br><label for="exampleFormControlInput1" class="form-label">Modelo</label>
                  <input type="text" maxlength="20" name="modelo" class="form-control" id="modelo">
              </div>     
              <div class="mb-3">
                  <label for="exampleFormControlInput1" class="form-label">Cor</label>
                  <input type="text" maxlength="20" name="cor" class="form-control" id="cor">
              </div>     
              <div class="mb-3">
                  <label for="exampleFormControlInput1" class="form-label">Proprietário</label>
                  <input type="text" maxlength="50" name="proprietario" class="form-control" id="proprietario">
              </div>  
              <div class="mb-3">
                  <label for="exampleFormControlInput1" class="form-label">CPF</label>
                  <input type="text" minlength="11" maxlength="11" name="cpf" class="form-control" id="cpf">
              </div>  
              <div class="mb-3">
                  <label for="exampleFormControlInput1" class="form-label">Telefone</label>
                  <input type="text" minlength="10" maxlength="11" name="telefone" class="form-control" id="telefone">
              </div>  <br>
              <div class="col-auto">
                 <button id="botao" type="submit" class="btn btn-primary mb-3">Cadastrar</button>
              </div>
              <br><br>
          </fieldset>
        </form>
      </div>
        <script>
          function validarCPF(cpf) {
              cpf = cpf.replace(/\D/g, ''); // Remove caracteres não numéricos
      
              if (cpf.length !== 11 || /^(.)\1+$/.test(cpf)) {
                  return false; // CPF deve ter 11 dígitos e não pode ter todos os dígitos iguais
              }
              // Verificar o primeiro dígito verificador
            var sum = 0;
              for (var i = 0; i < 9; i++) 
              {
                sum += digits[i] * (10 - i);
              }
            var remainder = sum % 11;
            var digit1 = (remainder < 2) ? 0 : 11 - remainder;
              if (digit1 !== digits[9]) 
                {
                  swal("Campo Inválido!", "Por favor, informe um CPF válido.", "warning");
                  return false;
                } 

              // Verificar o segundo dígito verificador
            sum = 0;
           for (var j = 0; j < 10; j++) 
            {
               sum += digits[j] * (11 - j);
            }

            remainder = sum % 11;
            var digit2 = (remainder < 2) ? 0 : 11 - remainder;
              if (digit2 !== digits[10]) 
              {
                swal("Campo Inválido!", "Por favor, informe um CPF válido.", "warning");
                return false;
              }
  
            return true;
              

          }
          // Função para validar o formulário antes do envio
          function validarFormulario(event) {
              var cpfInput = document.getElementById('cpf');
              var cpf = cpfInput.value;
      
              if (!validarCPF(cpf)) {
                  alert('CPF inválido. Por favor, verifique o campo CPF.');
                  event.preventDefault(); // Impede o envio do formulário se o CPF for inválido
              }
          }
            

          // Adiciona o evento de validação ao formulário
          var form = document.getElementById('cadastroForm');
          form.addEventListener('submit', validarFormulario);

          // Adiciona o evento de digitação ao campo CPF
          var cpfInput = document.getElementById('cpf');
          cpfInput.addEventListener('keypress', validarDigitacaoNumerica);


          function validarFormulario(event) {
            var cpfInput = document.getElementById('cpf');
            var cpf = cpfInput.value;

            var placaInput = document.getElementById('placa');
            var placa = placaInput.value;

            var marcaInput = document.getElementById('marca');
            var marca = marcaInput.value;

            var modeloInput = document.getElementById('modelo');
            var modelo = modeloInput.value;

            var corInput = document.getElementById('cor');
            var cor = corInput.value;

            var proprietarioInput = document.getElementById('proprietario');
            var proprietario = proprietarioInput.value;

            var telefoneInput = document.getElementById('telefone');
            var telefone = telefoneInput.value;

    // Verifica se algum campo está vazio
          if (
              cpf === '' ||
              placa === '' ||
              marca === '' ||
              modelo === '' ||
              cor === '' ||
              proprietario === '' ||
              telefone === ''
          ) {
              alert('Por favor, preencha todos os campos.');
              event.preventDefault(); // Impede o envio do formulário se algum campo estiver vazio
          }
}
      </script>
      
    <br><br>
    <footer>
        <dl>
          <dt>E-mail</dt>
          <dd>contato@gmail.com</dd>
          <dt>Telefone</dt>
          <dd>(19)3544-8887</dd>
        </dl>
        <p>
          <a class="nav-link" href="#">Park Controll</a>
        </p>
      </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
</body>
</html>